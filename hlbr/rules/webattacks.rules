
# name:       webattacks.rules
# created by: Joao Eriberto Mota Filho
# date:       26 Dec 05
# update:     15 Feb 06
# target:     block www attacks.

<rule>
ip dst(www)
tcp dst(80)
tcp regex((\n|^)(GET|POST|PUT) +(\.|%252(e|E)|%2(e|E))+(/|%252(f|F)|%2(f|F)|\\|%255(c|C)|%5(c|C))+)
message=(webattacks-1-re) directory change attempt (unicode,asc,plain) 
action=action1
</rule>

<rule>
ip dst(www)
tcp dst(80)
tcp regex((\n|^)(GET|POST|PUT) [^\n]+(/|%252(f|F)|%2(f|F)|\\|%255(c|C)|%5(c|C))(\.|%252(e|E)|%2(e|E))+(/|%252(f|F)|%2(f|F)|\\|%255(c|C)|%5(c|C))+)
message=(webattacks-2-re) directory change attempt (unicode,asc,plain) 
action=action1
</rule>

<rule>
ip dst(www)
tcp dst(80)
tcp regex(\.+:+\.+)
message=(webattacks-3-re) request ..:..:.. 
action=action1
</rule>



